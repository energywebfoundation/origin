FROM node:14-alpine

ARG VERSION=latest

RUN apk --no-cache add make gcc g++ python
RUN for i in 1 2 3 4 5; do yarn global add @energyweb/solar-simulator@${VERSION} && break || sleep 15; done

RUN mkdir /var/deployment
COPY ./ /var/deployment

WORKDIR /var/deployment/apps/packages/tools/solar-simulator

CMD ["solar-simulator"]