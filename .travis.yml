sudo: required
dist: bionic
language: node_js
node_js:
    - '10'

cache:
    yarn: true
    directories:
        - packages/utils-general/build
        - packages/utils-general/dist
        - packages/user-registry/schemas
        - packages/user-registry/build
        - packages/user-registry/dist
        - packages/utils-testbackend/dist
        - packages/asset-registry/schemas
        - packages/asset-registry/build
        - packages/asset-registry/dist
        - packages/origin/build
        - packages/origin/dist
        - packages/market/schemas
        - packages/market/build
        - packages/market/dist

before_install:
    - sh scripts/restore-original-timestamps.sh

install:
    - yarn
    - yarn build
    - yarn lint

script: yarn test

jobs:
  include:
    - stage: "Tests"
      name: "User Registry Tests"
      script: yarn test:user-registry
    - name: "Asset Registry Tests"    
      script: yarn test:asset-registry
    - name: "Origin Tests"    
      script: yarn test:origin
    - name: "Market Tests"
      script: yarn test:market
    - name: "UI Tests"    
      script: yarn test:ui
    - name: "Matcher And Event Listener Tests"    
      script: yarn test